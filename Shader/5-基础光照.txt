1.渲染总是围绕一个基础问题：如何决定一个像素的颜色；
宏观来说，渲染包含两大部分：决定一个像素的可见性，决定这个像素的光照计算
光照模型：用于决定在一个像素上进行怎样的光照计算。

2.光照相关术语
如何测量一个光源发射出了多少光，辐照度：就是对光的量化
光线与物体相交的结果：散射和吸收
散射有两种：折射和反射，在光照模型中分为两种，
高光反射部分：表示物体表面是如何反射光线的。
漫反射：表示有多少光线会被折射、吸收和散射出表面。
出射度：计算出射光线的数量和方向

着色：根据材质属性（如漫反射属性等）、光源信息（光源方向，辐照度等），使用一个等式计算沿某个观察方向的出射度的过程。我们也把这个等式称为光照模型。（Lighting Model）

3.标准光照模型
把进入到摄像机内部的光线分为4个部分：
自发光（emissive）部分：使用Cemissive表示，这个部分用于描述当给定一个方向时，一个表面本身会向该方向发射多少辐射量。需要注意的是：如果没有使用全局光照，这些自发光的表面并不会真的照亮周围的物体，而只是让它本身看起来更亮而已。
高光反射（specular）部分：使用Cspecular表示。这个部分白哦是当光线从光源照射到模型表面时，表面会在完全镜面反射方向散射多少辐射量。
漫反射（diffuse）部分：使用Cdiffuse表示，用于描述，当光线从光源照射到模型表面时，该表面会向每个方向散射多少辐射量。
环境光（ambient）部分：使用Cambient表示，用于描述其它所有的间接光照。

漫反射光照符合兰伯特定律：反射光线的强度与表面法线和光源方向之间的夹角的余弦值成正比。
Cdiffuse=(Clight*mdiffuse)max(0,n*l);
需要四个参数：入射光线的颜色和强度，材质的漫反射系数，表面法线以及光源方向。
Cg中的saturate(x)函数：为了防止点积结果为负值
把x截取在[0,1]范围内，如果x是一个矢量，那么会对它的每一个分量进行这样的操作。

4.逐像素/逐顶点
在哪计算光照模型？
逐顶点光照在顶点着色器中计算，phone着色技术。
逐像素光照在片元着色器中计算，高洛德着色技术。
由于顶点数目远远小于像素数目，所以逐顶点光照的计算量往往要小于逐像素光照。
使用逐顶点计算的高光是有问题的，因为高光反射部分不是线性的，而顶点着色器中计算光照再线性插值的过程是线性的。
由于逐顶点光照会在渲染图元内部对顶点颜色进行插值，这会导致渲染图元内部的颜色总是暗于顶点处的颜色，这在某些情况下会产生明显的棱角现象。

5.逐顶点光照->逐像素光照
将光照模型的计算从vert函数移到frag函数中，并修改顶点着色器的输出结构体
在Diffuse光照模型中，需要把输出结构体中的颜色变量去除，添加顶点在世界空间中的法线，因为这个顶点传入片元着色器时被转换为裁剪空间的顶点坐标了，所以要在顶点计算出该法线，用于lambert公式的dot()计算。
在Specular光照模型中，需要把颜色变量去除，添加顶点在世界空间中的法线，以及顶点在世界空间中的坐标，用于计算摄像机的观察向量。